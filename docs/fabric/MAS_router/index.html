<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-fabric/MAS_router/mas_router" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">Router MAS | FPGA Multi-Agent FabrIc Architecture </title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://fpga-mafia.github.io /fpga_mafia_wiki/docs/fabric/MAS_router/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Router MAS | FPGA Multi-Agent FabrIc Architecture "><meta data-rh="true" name="description" content="Brief Description:"><meta data-rh="true" property="og:description" content="Brief Description:"><link data-rh="true" rel="icon" href="/fpga_mafia_wiki/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://fpga-mafia.github.io /fpga_mafia_wiki/docs/fabric/MAS_router/"><link data-rh="true" rel="alternate" href="https://fpga-mafia.github.io /fpga_mafia_wiki/docs/fabric/MAS_router/" hreflang="en"><link data-rh="true" rel="alternate" href="https://fpga-mafia.github.io /fpga_mafia_wiki/docs/fabric/MAS_router/" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/fpga_mafia_wiki/blog/rss.xml" title="FPGA Multi-Agent FabrIc Architecture  RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/fpga_mafia_wiki/blog/atom.xml" title="FPGA Multi-Agent FabrIc Architecture  Atom Feed"><link rel="stylesheet" href="/fpga_mafia_wiki/assets/css/styles.7948e28b.css">
<link rel="preload" href="/fpga_mafia_wiki/assets/js/runtime~main.1b417754.js" as="script">
<link rel="preload" href="/fpga_mafia_wiki/assets/js/main.3bf9e8d7.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/fpga_mafia_wiki/"><div class="navbar__logo"><img src="/fpga_mafia_wiki/img/BIU.png" alt="BIU logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/fpga_mafia_wiki/img/BIU.png" alt="BIU logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">FPGA MAFIA</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/fpga_mafia_wiki/docs/fabric/intro">Fabric</a><a class="navbar__item navbar__link" href="/fpga_mafia_wiki/docs/rvc/intro">RISCV_Cores</a><a class="navbar__item navbar__link" href="/fpga_mafia_wiki/docs/cache/cache_intro">Cache</a><a class="navbar__item navbar__link" href="/fpga_mafia_wiki/docs/IPs/IPs_intro">IPs</a><a class="navbar__item navbar__link" href="/fpga_mafia_wiki/docs/fpga/fpga_intro">FPGA</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/fpga_mafia_wiki/docs/TFM/welcome">TFM</a><a class="navbar__item navbar__link" href="/fpga_mafia_wiki/docs/build_script/intro">MAFIA_Build</a><a href="https://github.com/amichai-bd/fpga_mafia" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub - Project<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/amichai-bd/fpga_mafia_wiki" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub - Wiki<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/fpga_mafia_wiki/docs/fabric/intro">intro</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/fpga_mafia_wiki/docs/fabric/MAS_fabric/mas_intro">Fabric HAS</a><button aria-label="Toggle the collapsible sidebar category &#x27;Fabric HAS&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/fpga_mafia_wiki/docs/fabric/MAS_router/mas_intro">Router HAS</a><button aria-label="Toggle the collapsible sidebar category &#x27;Router HAS&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/fpga_mafia_wiki/docs/fabric/MAS_router/">Router MAS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/fpga_mafia_wiki/docs/fabric/MAS_router/mas_next_tile_fifo_arb">Next_tile_fifo_arb MAS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/fpga_mafia_wiki/docs/fabric/MAS_router/mas_fifo_arb">FIFO_arb MAS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/fpga_mafia_wiki/docs/fabric/MAS_router/mas_arbiter">Arbiter MAS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/fpga_mafia_wiki/docs/fabric/MAS_router/mas_fifo">FIFO MAS</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/fpga_mafia_wiki/docs/fabric/verification/verification_intro">Fabric Verification</a><button aria-label="Toggle the collapsible sidebar category &#x27;Fabric Verification&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/fpga_mafia_wiki/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/fpga_mafia_wiki/docs/fabric/MAS_router/mas_intro"><span itemprop="name">Router HAS</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Router MAS</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Router MAS</h1><h1>1. Overview</h1><p>Brief Description:
This document outlines the micro-architecture of the router module, which is designed to route and arbitrate requests between different directions (North, East, West, South, Local) in a tile-based system. It handles request validity, transaction details, and arbitration for data exchange.</p><p>Purpose and Functionality:
The router module is responsible for routing and arbitrating data requests between various directions based on input validity and arbitration logic. It ensures efficient communication between tiles within the system.</p><h1>2. Block Diagram</h1><p><img loading="lazy" alt="router" src="/fpga_mafia_wiki/assets/images/router-d5a213e97294baa03340316a5b1530ec.jpg" width="1024" height="954" class="img_ev3q"></p><h1>3. Interfaces</h1><p>Signal tables:</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="common-signals">Common Signals:<a href="#common-signals" class="hash-link" aria-label="Direct link to Common Signals:" title="Direct link to Common Signals:">​</a></h2><table><thead><tr><th>Signal Name</th><th>Direction</th><th>Description</th></tr></thead><tbody><tr><td>clk</td><td>Input</td><td>Clock signal.</td></tr><tr><td>rst</td><td>Input</td><td>Reset signal.</td></tr><tr><td>local_tile_id</td><td>Input</td><td>The ID of the current tile.</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="north-interface">North Interface:<a href="#north-interface" class="hash-link" aria-label="Direct link to North Interface:" title="Direct link to North Interface:">​</a></h2><table><thead><tr><th>Signal Name</th><th>Direction</th><th>Description</th></tr></thead><tbody><tr><td>in_north_req_valid</td><td>Input</td><td>Signal indicating the validity of requests from the North direction.</td></tr><tr><td>in_north_req</td><td>Input</td><td>Transaction details for requests from the North direction.</td></tr><tr><td>in_north_ready</td><td>Input</td><td>Ready signal indicating the availability for data exchange from the North direction.</td></tr><tr><td>out_north_ready</td><td>Output</td><td>Ready signal indicating the availability for data exchange to the North direction.</td></tr><tr><td>out_north_req_valid</td><td>Output</td><td>Signal indicating the validity of requests forwarded to the North direction.</td></tr><tr><td>out_north_req</td><td>Output</td><td>Transaction details for requests forwarded to the North direction.</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="east-interface">East Interface:<a href="#east-interface" class="hash-link" aria-label="Direct link to East Interface:" title="Direct link to East Interface:">​</a></h2><table><thead><tr><th>Signal Name</th><th>Direction</th><th>Description</th></tr></thead><tbody><tr><td>in_east_req_valid</td><td>Input</td><td>Signal indicating the validity of requests from the East direction.</td></tr><tr><td>in_east_req</td><td>Input</td><td>Transaction details for requests from the East direction.</td></tr><tr><td>in_east_ready</td><td>Input</td><td>Ready signal indicating the availability for data exchange from the East direction.</td></tr><tr><td>out_east_ready</td><td>Output</td><td>Ready signal indicating the availability for data exchange to the East direction.</td></tr><tr><td>out_east_req_valid</td><td>Output</td><td>Signal indicating the validity of requests forwarded to the East direction.</td></tr><tr><td>out_east_req</td><td>Output</td><td>Transaction details for requests forwarded to the East direction.</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="west-interface">West Interface:<a href="#west-interface" class="hash-link" aria-label="Direct link to West Interface:" title="Direct link to West Interface:">​</a></h2><table><thead><tr><th>Signal Name</th><th>Direction</th><th>Description</th></tr></thead><tbody><tr><td>in_west_req_valid</td><td>Input</td><td>Signal indicating the validity of requests from the West direction.</td></tr><tr><td>in_west_req</td><td>Input</td><td>Transaction details for requests from the West direction.</td></tr><tr><td>in_west_ready</td><td>Input</td><td>Ready signal indicating the availability for data exchange from the West direction.</td></tr><tr><td>out_west_ready</td><td>Output</td><td>Ready signal indicating the availability for data exchange to the West direction.</td></tr><tr><td>out_west_req_valid</td><td>Output</td><td>Signal indicating the validity of requests forwarded to the West direction.</td></tr><tr><td>out_west_req</td><td>Output</td><td>Transaction details for requests forwarded to the West direction.</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="south-interface">South Interface:<a href="#south-interface" class="hash-link" aria-label="Direct link to South Interface:" title="Direct link to South Interface:">​</a></h2><table><thead><tr><th>Signal Name</th><th>Direction</th><th>Description</th></tr></thead><tbody><tr><td>in_south_req_valid</td><td>Input</td><td>Signal indicating the validity of requests from the South direction.</td></tr><tr><td>in_south_req</td><td>Input</td><td>Transaction details for requests from the South direction.</td></tr><tr><td>in_south_ready</td><td>Input</td><td>Ready signal indicating the availability for data exchange from the South direction.</td></tr><tr><td>out_south_ready</td><td>Output</td><td>Ready signal indicating the availability for data exchange to the South direction.</td></tr><tr><td>out_south_req_valid</td><td>Output</td><td>Signal indicating the validity of requests forwarded to the South direction.</td></tr><tr><td>out_south_req</td><td>Output</td><td>Transaction details for requests forwarded to the South direction.</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="local-interface">Local Interface:<a href="#local-interface" class="hash-link" aria-label="Direct link to Local Interface:" title="Direct link to Local Interface:">​</a></h2><table><thead><tr><th>Signal Name</th><th>Direction</th><th>Description</th></tr></thead><tbody><tr><td>in_local_req_valid</td><td>Input</td><td>Signal indicating the validity of requests from the Local direction.</td></tr><tr><td>in_local_req</td><td>Input</td><td>Transaction details for requests from the Local direction.</td></tr><tr><td>in_local_ready</td><td>Input</td><td>Ready signal indicating the availability for data exchange from the Local direction.</td></tr><tr><td>out_local_ready</td><td>Output</td><td>Ready signal indicating the availability for data exchange to the Local direction.</td></tr><tr><td>out_local_req_valid</td><td>Output</td><td>Signal indicating the validity of requests forwarded to the Local direction.</td></tr><tr><td>out_local_req</td><td>Output</td><td>Transaction details for requests forwarded to the Local direction.</td></tr></tbody></table><h1>4. Functional Description</h1><p>Operational Modes:</p><p>The router module operates in various modes depending on the input validity signals and arbitration logic. It routes and forwards requests between different directions while ensuring data integrity.</p><p>Data Flow Description:</p><ol><li>The module receives requests from various directions, each with its associated validity signal, transaction details, and ready signal.</li><li>It performs arbitration to determine the priority of requests from different directions.</li><li>The selected request is then forwarded to the appropriate output direction.</li><li>Ready signals are asserted to indicate the availability for data exchange in the selected direction.</li></ol><ul><li>One of the main issues that we had was the HOL(head of line) problem, first lets explain the issue.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="head-of-line-blocking-hol">Head-of-Line Blocking (HOL):<a href="#head-of-line-blocking-hol" class="hash-link" aria-label="Direct link to Head-of-Line Blocking (HOL):" title="Direct link to Head-of-Line Blocking (HOL):">​</a></h3><ul><li>HOL blocking happens when a packet at the head of a queue in a router or switch prevents other packets behind it from being forwarded, even if those subsequent packets are destined for different output ports.</li><li>Essentially, the presence of a single stalled or delayed packet can cause congestion and block the transmission of all other packets in the same queue, leading to inefficient use of network resources.</li><li>This situation arises because packet switching devices typically process packets in a first-in-first-out (FIFO) manner, where packets are forwarded in the order they arrive. If a packet at the front of the queue encounters a delay (e.g., due to processing or waiting for an available output port), all subsequent packets in the same queue are also delayed, regardless of their priority or urgency.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="impact-of-hol">Impact of HOL:<a href="#impact-of-hol" class="hash-link" aria-label="Direct link to Impact of HOL:" title="Direct link to Impact of HOL:">​</a></h3><ul><li>HOL blocking can significantly degrade network performance by increasing packet latency, reducing throughput, and causing jitter.</li><li>In worst-case scenarios, HOL blocking can lead to packet loss and network congestion, especially in high-traffic environments.</li><li>It becomes more pronounced in networks with bursty traffic patterns or when there are disparities in the arrival rates of packets destined for different output ports.</li></ul><p>In our design, HOL blocking can occur if we naively insert only one fifo_arb for each router (to save space), with the output connected to other tiles. In this setup, if there is a transaction destined for the north, and behind it, there is a transaction bound for the south, the south transaction gets blocked by the north transaction. In other words, if the north tile is not ready, all other transactions will be stuck behind it.</p><p>The router module that addresses the HOL blocking problem by efficiently managing the allocation of communication resources among multiple incoming requests. Here&#x27;s how the router module achieves this:</p><ol><li><p><strong>Input Buffering</strong>:</p><ul><li>Incoming communication requests from neighboring tiles are first buffered in FIFO buffers within the <code>fifo_arb</code> module. Each FIFO buffer corresponds to a particular communication channel or direction, more info on the <a href="/fpga_mafia_wiki/docs/fabric/MAS_router/mas_fifo_arb">mas_fifo_arb tab</a></li></ul></li><li><p><strong>Arbitration</strong>:</p><ul><li>The <code>fifo_arb</code> module uses the <code>arbiter</code> module to arbitrate among the buffered requests. The <code>arbiter</code> ensures fair access to the communication resources by selecting one request at a time based on a round-robin scheduling policy.</li><li>The arbitration process ensures that no single communication request monopolizes the communication resources, preventing HOL blocking by allowing all requests to be serviced in a fair and timely manner.</li></ul></li><li><p><strong>Dynamic Selection</strong>:</p><ul><li>The <code>arbiter</code> module dynamically selects the next valid request from the buffered requests, considering factors such as whether the FIFO buffer has data and whether the corresponding arbiter is ready to accept data.</li><li>This dynamic selection ensures that if one FIFO buffer becomes empty or is not ready to accept data, the arbiter can quickly select another valid request from the remaining buffered requests.</li></ul></li><li><p><strong>Optimized Routing</strong>:</p><ul><li>Once a request is selected by the <code>arbiter</code>, the <code>fifo_arb</code> module routes the corresponding data packet to the appropriate output port or neighboring tile.</li><li>By efficiently managing the routing of data packets based on the selected requests, the router module optimizes the usage of communication resources and minimizes the chances of HOL blocking.</li></ul></li><li><p><strong>Continuous Operation</strong>:</p><ul><li>The router module operates continuously, buffering incoming requests, arbitrating among them, and routing data packets based on the arbitration results.</li><li>This continuous operation ensures that communication resources are utilized effectively and that incoming requests are processed without delays or bottlenecks caused by HOL blocking.</li></ul></li></ol><p>In summary, the router module utilizing the <code>fifo_arb</code> module, which incorporates the <code>arbiter</code> module, solves the HOL blocking problem by efficiently managing communication resources, ensuring fair access to these resources, and dynamically selecting and routing data packets based on incoming requests.</p><p>Waveform example:</p><p><img loading="lazy" alt="router" src="/fpga_mafia_wiki/assets/images/router_tile_33-56e69f261eb4741aff4f30df7f63e05c.jpg" width="1600" height="573" class="img_ev3q"></p><p>In this waveform, we can observe the routing process in action. The router receives a request from the north, as indicated by the &#x27;in_north_req&#x27; signal. After evaluating the request and determining the appropriate routing path, the router decides to forward this request westward. This decision is reflected in the &#x27;out_west_req&#x27; signal, which becomes active, signifying that the request is being sent in the west direction. Additionally, we can see that the &#x27;valid&#x27; and &#x27;ready&#x27; signals are asserted correctly, ensuring a smooth and efficient data exchange between the different interfaces of the router. This example demonstrates the router&#x27;s ability to dynamically route requests based on their destination, while managing the flow control signals to maintain data integrity and prevent congestion.</p><h1>5. Tests and verification</h1><p>Since one of the main issues was the occurrence of HOL, we needed to test it directly to provoke HOL and then verify its resolution. Therefore, we devised a Back Pressure (BP) test. This test fills all the FIFOs in the router and prevents any transactions from being released. At a certain point, after all the FIFOs are full, we release the blocking and allow the data to flow. Subsequently, we expect to observe that all the transactions that managed to enter the FIFOs are processed. Additionally, we aim to ensure that the router does not accept any new transactions while it is full, thus preventing any transactions from disappearing.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/FPGA-MAFIA/fpga_mafia_wiki/tree/main/docs/fabric/MAS_router/mas_router.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/fpga_mafia_wiki/docs/fabric/MAS_router/mas_intro"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Router Intro</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/fpga_mafia_wiki/docs/fabric/MAS_router/mas_next_tile_fifo_arb"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Next_tile_fifo_arb MAS</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#common-signals" class="table-of-contents__link toc-highlight">Common Signals:</a></li><li><a href="#north-interface" class="table-of-contents__link toc-highlight">North Interface:</a></li><li><a href="#east-interface" class="table-of-contents__link toc-highlight">East Interface:</a></li><li><a href="#west-interface" class="table-of-contents__link toc-highlight">West Interface:</a></li><li><a href="#south-interface" class="table-of-contents__link toc-highlight">South Interface:</a></li><li><a href="#local-interface" class="table-of-contents__link toc-highlight">Local Interface:</a><ul><li><a href="#head-of-line-blocking-hol" class="table-of-contents__link toc-highlight">Head-of-Line Blocking (HOL):</a></li><li><a href="#impact-of-hol" class="table-of-contents__link toc-highlight">Impact of HOL:</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Contributors</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.linkedin.com/in/amichai-ben-david" target="_blank" rel="noopener noreferrer" class="footer__link-item">Amichai Ben-David</a></li><li class="footer__item"><a href="https://www.linkedin.com/in/noam-sabban" target="_blank" rel="noopener noreferrer" class="footer__link-item">Noam Sabban</a></li><li class="footer__item"><a href="https://github.com/ShmuelSfez" target="_blank" rel="noopener noreferrer" class="footer__link-item">Shmuel Sfez</a></li><li class="footer__item"><a href="https://github.com/yeonatanPerelman" target="_blank" rel="noopener noreferrer" class="footer__link-item">Yeonatan Perelman</a></li><li class="footer__item"><a href="https://github.com/danielk532" target="_blank" rel="noopener noreferrer" class="footer__link-item">Daniel Kaufman</a></li><li class="footer__item"><a href="https://www.linkedin.com/in/roman-gilgor-a5326532/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Roman Gilgor</a></li></ul></div><div class="col footer__col"><div class="footer__title">RTL Units</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/fpga_mafia_wiki/docs/fabric/intro">Fabric</a></li><li class="footer__item"><a class="footer__link-item" href="/fpga_mafia_wiki/docs/fabric/intro">- Tile</a></li><li class="footer__item"><a class="footer__link-item" href="/fpga_mafia_wiki/docs/fabric/intro">- Router</a></li><li class="footer__item"><a class="footer__link-item" href="/fpga_mafia_wiki/docs/rvc/intro">RISCV Cores</a></li><li class="footer__item"><a class="footer__link-item" href="/fpga_mafia_wiki/docs/cache/cache_intro">Memory Subsystem</a></li><li class="footer__item"><a class="footer__link-item" href="/fpga_mafia_wiki/docs/cache/cache_intro">- Instruction Cache</a></li><li class="footer__item"><a class="footer__link-item" href="/fpga_mafia_wiki/docs/cache/cache_intro">- Data Cache</a></li><li class="footer__item"><a class="footer__link-item" href="/fpga_mafia_wiki/docs/cache/cache_intro">- Memory Controller</a></li></ul></div><div class="col footer__col"><div class="footer__title">TFM</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/fpga_mafia_wiki/docs/TFM/projectTool/intro">Project Tool</a></li><li class="footer__item"><a class="footer__link-item" href="/fpga_mafia_wiki/docs/TFM/projectTool/git_and_github">- Git &amp; GitHub</a></li><li class="footer__item"><a class="footer__link-item" href="/fpga_mafia_wiki/docs/TFM/projectTool/GccRiscV">- RISCV GCC</a></li><li class="footer__item"><a class="footer__link-item" href="/fpga_mafia_wiki/docs/TFM/projectTool/ModelSim">- Modelsim</a></li><li class="footer__item"><a class="footer__link-item" href="/fpga_mafia_wiki/docs/TFM/projectTool/ModelSim">- Quartus</a></li><li class="footer__item"><a class="footer__link-item" href="/fpga_mafia_wiki/docs/TFM/verilog/intro">System-Verilog</a></li></ul></div><div class="col footer__col"><div class="footer__title">GitHub - links</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/amichai-bd/fpga_mafia" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub - FPGA MAFIA<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/amichai-bd/fpga_mafia_wiki" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub - FPGA MAFIA WIKI<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 MAFIA Project</div></div></div></footer></div>
<script src="/fpga_mafia_wiki/assets/js/runtime~main.1b417754.js"></script>
<script src="/fpga_mafia_wiki/assets/js/main.3bf9e8d7.js"></script>
</body>
</html>